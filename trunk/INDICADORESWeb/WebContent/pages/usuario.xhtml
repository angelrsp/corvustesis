<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui">


<ui:composition template="/template/privado.xhtml">
	<ui:define name="contenido">
		<h:form id="contenido" enctype="multipart/form-data">
	
			<p:growl id="growl" showDetail="false" />	

			<p:panel id="pnlUsuarios" header="Usuarios">
			
			<table>
			
				<tr>
					<td><h:outputLabel value="#{i18n['label.ies']}:&#160;" /> </td>
					<td><p:selectOneMenu required="true" requiredMessage="#{i18n['label.ies']}:&#160;#{i18n['label.requerido']}" value="#{usuarioController.iesSelect}">
							<f:selectItem itemLabel="#{i18n['combo.seleccionar']}" itemValue=""/>
							<f:selectItems value="#{usuarioController.iesList}"></f:selectItems>
							<p:ajax event="change" listener="#{usuarioController.readUser}" process="@this" update="pnlUsuarios"/>
					</p:selectOneMenu></td>
				</tr>			
			
				<tr>
					<td><h:outputText value="Usuario:" /></td>
					<td><p:inputText value="#{usuarioController.user.usuLogin}" required="true"/></td>
				</tr>
				<tr>	
					<td><h:outputLabel value="Contraseña:&#160;" /> </td>
					<td><p:password id="pass1" value="#{usuarioController.user.usuClave}" required="true" feedback="true" match="pass2"/></td>
				</tr>
				<tr>	
					<td><h:outputLabel value="Confirmar Contraseña:&#160;" /> </td>
					<td><p:password id="pass2" value="#{usuarioController.user.usuClave}" required="true" feedback="true"/></td>		
				</tr>
				
				<tr>
					<td><h:outputLabel value="#{i18n['label.perfil']}:&#160;" /> </td>
					<td><p:selectOneMenu required="true" requiredMessage="#{i18n['label.perfil']}:&#160;#{i18n['label.requerido']}" value="#{usuarioController.perfilSelect}">
							<f:selectItem itemLabel="#{i18n['combo.seleccionar']}" itemValue=""/>
							<f:selectItems value="#{usuarioController.perfilList}" var="per" itemValue="#{per.perCodigo}" itemLabel="#{per.perDescripcion}"/>
					</p:selectOneMenu></td>
				</tr>							
				
				<tr>
					<td><p:commandButton value="#{i18n['boton.guardar']}" actionListener="#{usuarioController.createUser}" process="pnlUsuarios" update="pnlUsuarios,growl"/></td>																		
				</tr>
			
			</table>

			<p:dataTable value="#{usuarioController.userList}" var="usu">
			
				<p:column headerText="Usuario">
					<h:outputText value="#{usu.usuLogin}" />
				</p:column>

				<p:column headerText="Institución de Educacion Superior">
					<h:outputText value="#{usu.indy.iesRazonSocial}" />
				</p:column>

				<p:column headerText="Perfil">
					<h:outputText value="#{usu.indUsuarioPerfils.get(0).indPerfil.perDescripcion}" />
				</p:column>

										
			</p:dataTable>
			
			</p:panel>

		</h:form>
	</ui:define>
</ui:composition>


</html>